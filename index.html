<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Stretching Routine</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link href="src/main.css" rel="stylesheet">
</head>
<body>

<div class="universe"
     x-data="app()"
     x-init="() => { init($watch) }">
    <div class="timer">
        Session: <span x-text="formattedSessionLength"></span>
    </div>

    <div class="progress"
         x-bind:style="`--step-total: ${step.total}; --step-current: ${step.current}; --step-duration: ${currentStepDuration.exercise}s`"
         x-bind:class="stage">
        <div class="progress__past"></div>

        <div class="progress__now"
             x-show="state === states.STARTED"></div>

        <div class="progress__finished"
             x-show="state === states.FINISHED"></div>
    </div>

    <section class="settings vertical-stack"
             x-show="state === states.SETTINGS">
        <div class="control">
            <label class="horizontal-stack">
                <span>The length of an exercise is</span>
                <input min="15"
                       max="60"
                       step="5"
                       type="number"
                       x-model.number="duration.exercise">
                <span>seconds.</span>
            </label>
        </div>

        <div class="control">
            <label class="horizontal-stack">
                <span>Pause</span>
                <input type="number"
                       min="3"
                       max="10"
                       step="1"
                       x-model.number="duration.between">
                <span>seconds between exercises.</span>
            </label>
        </div>

        <div class="control">
            <label class="horizontal-stack">
                <input min="3"
                       step="1"
                       type="number"
                       x-model.number="duration.buffer">
                <span>seconds are needed before the exercises.</span>
            </label>
        </div>

        <div class="control">
            <label class="horizontal-stack">
                <span>Play</span>
                <select x-model="sound.start">
                    <option disabled selected>Select sound</option>
                    <template x-for="(item, index) in sounds"
                              x-bind:key="'sound-start-' + index">
                        <option x-bind:value="item.src"
                                x-text="item.name"></option>
                    </template>
                </select>
                <span>when the exercise starts.</span>
            </label>
        </div>

        <div class="control">
            <label class="horizontal-stack">
                <span>When exercise ends, play</span>
                <select x-model="sound.stop">
                    <option disabled selected>Select sound</option>
                    <template x-for="(item, index) in sounds"
                              x-bind:key="'sound-stop-' + index">
                        <option x-bind:value="item.src"
                                x-text="item.name"></option>
                    </template>
                </select>
                <span>.</span>
            </label>
        </div>

        <button type="button" x-on:click.prevent="start()">Start</button>

        <div>&nbsp;</div>

        <div class="text-small">
            <a href="https://github.com/meszarosrob/stretching-routine#readme">Wait a moment! WTF is this?</a>
        </div>

    </section>

    <template x-if="state === states.BUFFER"
              key="state-buffer">
        <section>
            <div class="text-big text-center">Get ready...</div>
        </section>
    </template>

    <template x-if="state === states.STARTED"
              key="state-started">

        <section class="exercise vertical-stack">
            <div class="exercise__preview">
                <video width="640"
                       height="480"
                       autoplay
                       muted
                       loop
                       playsinline
                       x-bind:src="currentExercise.src"></video>
            </div>

            <div class="exercise__action horizontal-center-elements">

                <button type="button" x-on:click.prevent="pause()">Pause</button>

            </div>

        </section>

    </template>

    <template x-if="state === states.PAUSED"
              key="state-paused">
        <section>
            <div class="horizontal-stack horizontal-center-elements">
                <button type="button" x-on:click.prevent="resume()">Resume</button>
                <div>from <span x-text="currentExercise.name"></span></div>
            </div>
        </section>
    </template>

    <template x-if="state === states.BETWEEN"
              key="state-between">
        <section class="width-extended">
            <div class="text-center">
                <span class="text-medium">Next exercise</span><br>
                <strong class="text-big" x-text="currentExercise.name"></strong>
            </div>
        </section>
    </template>

    <template x-if="state === states.FINISHED"
              key="state-finished">
        <section>
            <div class="text-big text-center">...aaaaaaaaaaaaand done!</div>
        </section>
    </template>
</div>

<script src="src/main.js"></script>
</body>
</html>
